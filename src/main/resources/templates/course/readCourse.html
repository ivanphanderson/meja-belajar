<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Course</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
  <style>
      table {
          margin: auto;
          width: 70% !important;
          table-layout: fixed
      }

      .course-table:hover {
          transform: scale(1.05);
      }

      .course-table {
          cursor: pointer;
          transition: transform .5s;
      }

      .course-table td {
          word-wrap: break-word;
      }

      .center{
          display: flex;
          justify-content: center;
          align-items: center;
          margin-bottom: 20px;
      }

  </style>
</head>
<body>
<div th:if="${error!=null}" class="alert alert-danger" role="alert">
  <p th:text="${error}"></p>
</div>

<div class="center">
  <h1>All Courses in MejaBelajar</h1>
</div>
<div class="center">
  <a href="/course/create" class="btn btn-primary">Create New Course</a>
</div>

<button id="hideArchiveBtn" class="btn btn-secondary"onclick="hideArchivedRow()">Hide archived course</button>
<table id="coursesTable" class="table table-striped my-2">
  <thead>
  <tr>
    <th>Name</th>
    <th>Type</th>
    <th>Duration (in month)</th>
    <th>Description</th>
    <th>Status</th>
  </tr>
  </thead>
  <tbody>
  <tr class="course-table clickable-row" th:each="course : ${courses}" th:onclick="'javascript:rowClicked(\'' + ${course.getId()} + '\');'">
    <td th:text="${course.getCourseName()}"></td>
    <td th:text="${course.getCourseType()}"></td>
    <td th:text="${course.getCourseDuration()}"></td>
    <td th:text="${course.getCourseDescription()}"></td>
    <td>
      <span th:if="${course.isArchived() == true}">Archived</span>
      <span th:if="${course.isArchived() == false}">Active</span>
    </td>
  </tr>
  </tbody>
</table>
</body>

<script src='https://code.jquery.com/jquery-3.2.1.min.js'></script>
<script>
    function rowClicked(value) {
        location.href = "/course/" + value;
    }

    var hidden = false;

    function hideArchivedRow() {
        var tableRef = document.getElementById("coursesTable").getElementsByTagName("tbody")[0];
        var myText = "<span>Archived</span>";

        for (var i = 0; i < tableRef.rows.length; ++i) {
            if (hidden === false) {
                if (tableRef.rows[i].cells[4].innerHTML.trim() == myText) {
                    $(tableRef.rows[i]).hide();
                }
            } else {
                $(tableRef.rows[i]).show();
            }
        }
        if (hidden === false) {
            hidden = true;
            document.getElementById("hideArchiveBtn").innerHTML = "Show archived courses";
        } else {
            hidden = false;
            document.getElementById("hideArchiveBtn").innerHTML = "Hide archived courses";
        }
    }

</script>
</html>